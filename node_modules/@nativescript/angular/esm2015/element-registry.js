import { View, LayoutBase, Page, Frame, AbsoluteLayout, ActivityIndicator, BottomNavigation, Button, ContentView, DatePicker, DockLayout, GridLayout, HtmlView, Image, Label, ListPicker, ListView, Placeholder, Progress, ProxyViewContainer, Repeater, ScrollView, SearchBar, SegmentedBar, SegmentedBarItem, Slider, StackLayout, FlexboxLayout, Switch, TabView, TabStrip, TabStripItem, TabContentItem, Tabs, TextField, TextView, TimePicker, WebView, WrapLayout, FormattedString, Span } from '@nativescript/core';
export class InvisibleNode extends View {
    constructor() {
        super();
        this.nodeType = 1;
        this.nodeName = getClassName(this);
    }
    toString() {
        return `${this.nodeName}(${this.id})`;
    }
}
export class CommentNode extends InvisibleNode {
    constructor() {
        super();
        this.meta = {
            skipAddToDom: true,
        };
        this.id = CommentNode.id.toString();
        CommentNode.id += 1;
    }
}
CommentNode.id = 0;
export class TextNode extends InvisibleNode {
    constructor() {
        super();
        this.meta = {
            skipAddToDom: true,
        };
        this.id = TextNode.id.toString();
        TextNode.id += 1;
    }
}
TextNode.id = 0;
const getClassName = (instance) => instance.constructor.name;
const ɵ0 = getClassName;
export function isDetachedElement(element) {
    return element && element.meta && element.meta.skipAddToDom;
}
export function isView(view) {
    return view instanceof View;
}
export function isInvisibleNode(view) {
    return view instanceof InvisibleNode;
}
const elementMap = new Map();
const camelCaseSplit = /([a-z0-9])([A-Z])/g;
const defaultViewMeta = { skipAddToDom: false };
export function registerElement(elementName, resolver, meta) {
    const entry = { resolver, meta };
    elementMap.set(elementName, entry);
    elementMap.set(elementName.toLowerCase(), entry);
    elementMap.set(elementName.replace(camelCaseSplit, '$1-$2').toLowerCase(), entry);
}
export function getViewClass(elementName) {
    const entry = elementMap.get(elementName) || elementMap.get(elementName.toLowerCase());
    if (!entry) {
        throw new TypeError(`No known component for element ${elementName}.`);
    }
    try {
        return entry.resolver();
    }
    catch (e) {
        throw new TypeError(`Could not load view for: ${elementName}.${e}`);
    }
}
export function getViewMeta(nodeName) {
    const entry = elementMap.get(nodeName) || elementMap.get(nodeName.toLowerCase());
    return (entry && entry.meta) || defaultViewMeta;
}
export function isKnownView(elementName) {
    return elementMap.has(elementName) || elementMap.has(elementName.toLowerCase());
}
export function getSingleViewRecursive(nodes, nestLevel) {
    const actualNodes = nodes.filter((node) => !(node instanceof InvisibleNode));
    if (actualNodes.length === 0) {
        throw new Error(`No suitable views found in list template! ` + `Nesting level: ${nestLevel}`);
    }
    else if (actualNodes.length > 1) {
        throw new Error(`More than one view found in list template!` + `Nesting level: ${nestLevel}`);
    }
    const rootLayout = actualNodes[0];
    if (!rootLayout) {
        return getSingleViewRecursive(rootLayout.children, nestLevel + 1);
    }
    const parentLayout = rootLayout.parent;
    if (parentLayout instanceof LayoutBase) {
        let node = rootLayout.parentNode;
        parentLayout.removeChild(rootLayout);
        rootLayout.parentNode = node;
    }
    return rootLayout;
}
const ɵ1 = (parent, child, next) => {
    // Page cannot be added to Frame with _addChildFromBuilder (thwos "use defaultPage" error)
    if (isInvisibleNode(child)) {
        return;
    }
    else if (child instanceof Page) {
        parent.navigate({ create: () => child });
    }
    else {
        throw new Error('Only a Page can be a child of Frame');
    }
};
const frameMeta = {
    insertChild: ɵ1,
};
// Register default NativeScript components
// Note: ActionBar related components are registerd together with action-bar directives.
registerElement('AbsoluteLayout', () => AbsoluteLayout);
registerElement('ActivityIndicator', () => ActivityIndicator);
registerElement('BottomNavigation', () => BottomNavigation);
registerElement('Button', () => Button);
registerElement('ContentView', () => ContentView);
registerElement('DatePicker', () => DatePicker);
registerElement('DockLayout', () => DockLayout);
registerElement('Frame', () => Frame, frameMeta);
registerElement('GridLayout', () => GridLayout);
registerElement('HtmlView', () => HtmlView);
registerElement('Image', () => Image);
// Parse5 changes <Image> tags to <img>. WTF!
registerElement('img', () => Image);
registerElement('Label', () => Label);
registerElement('ListPicker', () => ListPicker);
registerElement('ListView', () => ListView);
registerElement('Page', () => Page);
registerElement('Placeholder', () => Placeholder);
registerElement('Progress', () => Progress);
registerElement('ProxyViewContainer', () => ProxyViewContainer);
registerElement('Repeater', () => Repeater);
registerElement('ScrollView', () => ScrollView);
registerElement('SearchBar', () => SearchBar);
registerElement('SegmentedBar', () => SegmentedBar);
registerElement('SegmentedBarItem', () => SegmentedBarItem);
registerElement('Slider', () => Slider);
registerElement('StackLayout', () => StackLayout);
registerElement('FlexboxLayout', () => FlexboxLayout);
registerElement('Switch', () => Switch);
registerElement('TabView', () => TabView);
registerElement('TabStrip', () => TabStrip);
registerElement('TabStripItem', () => TabStripItem);
registerElement('TabContentItem', () => TabContentItem);
registerElement('Tabs', () => Tabs);
registerElement('TextField', () => TextField);
registerElement('TextView', () => TextView);
registerElement('TimePicker', () => TimePicker);
registerElement('WebView', () => WebView);
registerElement('WrapLayout', () => WrapLayout);
registerElement('FormattedString', () => FormattedString);
registerElement('Span', () => Span);
registerElement('DetachedContainer', () => ProxyViewContainer, {
    skipAddToDom: true,
});
registerElement('page-router-outlet', () => Frame);
export { ɵ0, ɵ1 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudC1yZWdpc3RyeS5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8iLCJzb3VyY2VzIjpbImVsZW1lbnQtcmVnaXN0cnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsaUJBQWlCLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsa0JBQWtCLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsZUFBZSxFQUFFLElBQUksRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBbUIzZixNQUFNLE9BQWdCLGFBQWMsU0FBUSxJQUFJO0lBVy9DO1FBQ0MsS0FBSyxFQUFFLENBQUM7UUFFUixJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztRQUNsQixJQUFJLENBQUMsUUFBUSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBRUQsUUFBUTtRQUNQLE9BQU8sR0FBRyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQztJQUN2QyxDQUFDO0NBQ0Q7QUFFRCxNQUFNLE9BQU8sV0FBWSxTQUFRLGFBQWE7SUFHN0M7UUFDQyxLQUFLLEVBQUUsQ0FBQztRQUVSLElBQUksQ0FBQyxJQUFJLEdBQUc7WUFDWCxZ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SCxlQUFlLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLENBQU0sS0FBSyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWaWV3LCBMYXlvdXRCYXNlLCBQYWdlLCBGcmFtZSwgQWJzb2x1dGVMYXlvdXQsIEFjdGl2aXR5SW5kaWNhdG9yLCBCb3R0b21OYXZpZ2F0aW9uLCBCdXR0b24sIENvbnRlbnRWaWV3LCBEYXRlUGlja2VyLCBEb2NrTGF5b3V0LCBHcmlkTGF5b3V0LCBIdG1sVmlldywgSW1hZ2UsIExhYmVsLCBMaXN0UGlja2VyLCBMaXN0VmlldywgUGxhY2Vob2xkZXIsIFByb2dyZXNzLCBQcm94eVZpZXdDb250YWluZXIsIFJlcGVhdGVyLCBTY3JvbGxWaWV3LCBTZWFyY2hCYXIsIFNlZ21lbnRlZEJhciwgU2VnbWVudGVkQmFySXRlbSwgU2xpZGVyLCBTdGFja0xheW91dCwgRmxleGJveExheW91dCwgU3dpdGNoLCBUYWJWaWV3LCBUYWJTdHJpcCwgVGFiU3RyaXBJdGVtLCBUYWJDb250ZW50SXRlbSwgVGFicywgVGV4dEZpZWxkLCBUZXh0VmlldywgVGltZVBpY2tlciwgV2ViVmlldywgV3JhcExheW91dCwgRm9ybWF0dGVkU3RyaW5nLCBTcGFuIH0gZnJvbSAnQG5hdGl2ZXNjcmlwdC9jb3JlJztcblxuZXhwb3J0IGludGVyZmFjZSBWaWV3Q2xhc3Mge1xuXHRuZXcgKCk6IFZpZXc7XG59XG5leHBvcnQgaW50ZXJmYWNlIFZpZXdFeHRlbnNpb25zIHtcblx0bWV0YTogVmlld0NsYXNzTWV0YTtcblx0bm9kZVR5cGU6IG51bWJlcjtcblx0bm9kZU5hbWU6IHN0cmluZztcblx0cGFyZW50Tm9kZTogTmdWaWV3O1xuXHRuZXh0U2libGluZzogTmdWaWV3O1xuXHRwcmV2aW91c1NpYmxpbmc6IE5nVmlldztcblx0Zmlyc3RDaGlsZDogTmdWaWV3O1xuXHRsYXN0Q2hpbGQ6IE5nVmlldztcblx0bmdDc3NDbGFzc2VzOiBNYXA8c3RyaW5nLCBib29sZWFuPjtcbn1cblxuZXhwb3J0IHR5cGUgTmdWaWV3ID0gVmlldyAmIFZpZXdFeHRlbnNpb25zO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgSW52aXNpYmxlTm9kZSBleHRlbmRzIFZpZXcgaW1wbGVtZW50cyBOZ1ZpZXcge1xuXHRtZXRhOiB7IHNraXBBZGRUb0RvbTogYm9vbGVhbiB9O1xuXHRub2RlVHlwZTogbnVtYmVyO1xuXHRub2RlTmFtZTogc3RyaW5nO1xuXHRwYXJlbnROb2RlOiBOZ1ZpZXc7XG5cdG5leHRTaWJsaW5nOiBOZ1ZpZXc7XG5cdHByZXZpb3VzU2libGluZzogTmdWaWV3O1xuXHRmaXJzdENoaWxkOiBOZ1ZpZXc7XG5cdGxhc3RDaGlsZDogTmdWaWV3O1xuXHRuZ0Nzc0NsYXNzZXM6IE1hcDxzdHJpbmcsIGJvb2xlYW4+O1xuXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKCk7XG5cblx0XHR0aGlzLm5vZGVUeXBlID0gMTtcblx0XHR0aGlzLm5vZGVOYW1lID0gZ2V0Q2xhc3NOYW1lKHRoaXMpO1xuXHR9XG5cblx0dG9TdHJpbmcoKSB7XG5cdFx0cmV0dXJuIGAke3RoaXMubm9kZU5hbWV9KCR7dGhpcy5pZH0pYDtcblx0fVxufVxuXG5leHBvcnQgY2xhc3MgQ29tbWVudE5vZGUgZXh0ZW5kcyBJbnZpc2libGVOb2RlIHtcblx0cHJvdGVjdGVkIHN0YXRpYyBpZCA9IDA7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0c3VwZXIoKTtcblxuXHRcdHRoaXMubWV0YSA9IHtcblx0XHRcdHNraXBBZGRUb0RvbTogdHJ1ZSxcblx0XHR9O1xuXHRcdHRoaXMuaWQgPSBDb21tZW50Tm9kZS5pZC50b1N0cmluZygpO1xuXHRcdENvbW1lbnROb2RlLmlkICs9IDE7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFRleHROb2RlIGV4dGVuZHMgSW52aXNpYmxlTm9kZSB7XG5cdHByb3RlY3RlZCBzdGF0aWMgaWQgPSAwO1xuXG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHN1cGVyKCk7XG5cblx0XHR0aGlzLm1ldGEgPSB7XG5cdFx0XHRza2lwQWRkVG9Eb206IHRydWUsXG5cdFx0fTtcblx0XHR0aGlzLmlkID0gVGV4dE5vZGUuaWQudG9TdHJpbmcoKTtcblx0XHRUZXh0Tm9kZS5pZCArPSAxO1xuXHR9XG59XG5cbmNvbnN0IGdldENsYXNzTmFtZSA9IChpbnN0YW5jZSkgPT4gaW5zdGFuY2UuY29uc3RydWN0b3IubmFtZTtcblxuZXhwb3J0IGludGVyZmFjZSBWaWV3Q2xhc3NNZXRhIHtcblx0c2tpcEFkZFRvRG9tPzogYm9vbGVhbjtcblx0aW5zZXJ0Q2hpbGQ/OiAocGFyZW50OiBhbnksIGNoaWxkOiBhbnksIG5leHQ/OiBhbnkpID0+IHZvaWQ7XG5cdHJlbW92ZUNoaWxkPzogKHBhcmVudDogYW55LCBjaGlsZDogYW55KSA9PiB2b2lkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNEZXRhY2hlZEVsZW1lbnQoZWxlbWVudCk6IGJvb2xlYW4ge1xuXHRyZXR1cm4gZWxlbWVudCAmJiBlbGVtZW50Lm1ldGEgJiYgZWxlbWVudC5tZXRhLnNraXBBZGRUb0RvbTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmlldyh2aWV3OiBhbnkpOiB2aWV3IGlzIE5nVmlldyB7XG5cdHJldHVybiB2aWV3IGluc3RhbmNlb2YgVmlldztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzSW52aXNpYmxlTm9kZSh2aWV3OiBhbnkpOiB2aWV3IGlzIEludmlzaWJsZU5vZGUge1xuXHRyZXR1cm4gdmlldyBpbnN0YW5jZW9mIEludmlzaWJsZU5vZGU7XG59XG5cbmV4cG9ydCB0eXBlIFZpZXdSZXNvbHZlciA9ICgpID0+IGFueTtcblxuY29uc3QgZWxlbWVudE1hcCA9IG5ldyBNYXA8c3RyaW5nLCB7IHJlc29sdmVyOiBWaWV3UmVzb2x2ZXI7IG1ldGE/OiBWaWV3Q2xhc3NNZXRhIH0+KCk7XG5jb25zdCBjYW1lbENhc2VTcGxpdCA9IC8oW2EtejAtOV0pKFtBLVpdKS9nO1xuY29uc3QgZGVmYXVsdFZpZXdNZXRhOiBWaWV3Q2xhc3NNZXRhID0geyBza2lwQWRkVG9Eb206IGZhbHNlIH07XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckVsZW1lbnQoZWxlbWVudE5hbWU6IHN0cmluZywgcmVzb2x2ZXI6IFZpZXdSZXNvbHZlciwgbWV0YT86IFZpZXdDbGFzc01ldGEpOiB2b2lkIHtcblx0Y29uc3QgZW50cnkgPSB7IHJlc29sdmVyLCBtZXRhIH07XG5cdGVsZW1lbnRNYXAuc2V0KGVsZW1lbnROYW1lLCBlbnRyeSk7XG5cdGVsZW1lbnRNYXAuc2V0KGVsZW1lbnROYW1lLnRvTG93ZXJDYXNlKCksIGVudHJ5KTtcblx0ZWxlbWVudE1hcC5zZXQoZWxlbWVudE5hbWUucmVwbGFjZShjYW1lbENhc2VTcGxpdCwgJyQxLSQyJykudG9Mb3dlckNhc2UoKSwgZW50cnkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Vmlld0NsYXNzKGVsZW1lbnROYW1lOiBzdHJpbmcpOiBhbnkge1xuXHRjb25zdCBlbnRyeSA9IGVsZW1lbnRNYXAuZ2V0KGVsZW1lbnROYW1lKSB8fCBlbGVtZW50TWFwLmdldChlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpKTtcblx0aWYgKCFlbnRyeSkge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoYE5vIGtub3duIGNvbXBvbmVudCBmb3IgZWxlbWVudCAke2VsZW1lbnROYW1lfS5gKTtcblx0fVxuXG5cdHRyeSB7XG5cdFx0cmV0dXJuIGVudHJ5LnJlc29sdmVyKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKGBDb3VsZCBub3QgbG9hZCB2aWV3IGZvcjogJHtlbGVtZW50TmFtZX0uJHtlfWApO1xuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRWaWV3TWV0YShub2RlTmFtZTogc3RyaW5nKTogVmlld0NsYXNzTWV0YSB7XG5cdGNvbnN0IGVudHJ5ID0gZWxlbWVudE1hcC5nZXQobm9kZU5hbWUpIHx8IGVsZW1lbnRNYXAuZ2V0KG5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpO1xuXHRyZXR1cm4gKGVudHJ5ICYmIGVudHJ5Lm1ldGEpIHx8IGRlZmF1bHRWaWV3TWV0YTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzS25vd25WaWV3KGVsZW1lbnROYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcblx0cmV0dXJuIGVsZW1lbnRNYXAuaGFzKGVsZW1lbnROYW1lKSB8fCBlbGVtZW50TWFwLmhhcyhlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNpbmdsZVZpZXdSZWN1cnNpdmUobm9kZXM6IEFycmF5PGFueT4sIG5lc3RMZXZlbDogbnVtYmVyKTogVmlldyB7XG5cdGNvbnN0IGFjdHVhbE5vZGVzID0gbm9kZXMuZmlsdGVyKChub2RlKSA9PiAhKG5vZGUgaW5zdGFuY2VvZiBJbnZpc2libGVOb2RlKSk7XG5cblx0aWYgKGFjdHVhbE5vZGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdHRocm93IG5ldyBFcnJvcihgTm8gc3VpdGFibGUgdmlld3MgZm91bmQgaW4gbGlzdCB0ZW1wbGF0ZSEgYCArIGBOZXN0aW5nIGxldmVsOiAke25lc3RMZXZlbH1gKTtcblx0fSBlbHNlIGlmIChhY3R1YWxOb2Rlcy5sZW5ndGggPiAxKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKGBNb3JlIHRoYW4gb25lIHZpZXcgZm91bmQgaW4gbGlzdCB0ZW1wbGF0ZSFgICsgYE5lc3RpbmcgbGV2ZWw6ICR7bmVzdExldmVsfWApO1xuXHR9XG5cblx0Y29uc3Qgcm9vdExheW91dCA9IGFjdHVhbE5vZGVzWzBdO1xuXHRpZiAoIXJvb3RMYXlvdXQpIHtcblx0XHRyZXR1cm4gZ2V0U2luZ2xlVmlld1JlY3Vyc2l2ZShyb290TGF5b3V0LmNoaWxkcmVuLCBuZXN0TGV2ZWwgKyAxKTtcblx0fVxuXG5cdGNvbnN0IHBhcmVudExheW91dCA9IHJvb3RMYXlvdXQucGFyZW50O1xuXHRpZiAocGFyZW50TGF5b3V0IGluc3RhbmNlb2YgTGF5b3V0QmFzZSkge1xuXHRcdGxldCBub2RlID0gcm9vdExheW91dC5wYXJlbnROb2RlO1xuXHRcdHBhcmVudExheW91dC5yZW1vdmVDaGlsZChyb290TGF5b3V0KTtcblx0XHRyb290TGF5b3V0LnBhcmVudE5vZGUgPSBub2RlO1xuXHR9XG5cblx0cmV0dXJuIHJvb3RMYXlvdXQ7XG59XG5cbmNvbnN0IGZyYW1lTWV0YTogVmlld0NsYXNzTWV0YSA9IHtcblx0aW5zZXJ0Q2hpbGQ6IChwYXJlbnQ6IEZyYW1lLCBjaGlsZDogTmdWaWV3LCBuZXh0OiBhbnkpID0+IHtcblx0XHQvLyBQYWdlIGNhbm5vdCBiZSBhZGRlZCB0byBGcmFtZSB3aXRoIF9hZGRDaGlsZEZyb21CdWlsZGVyICh0aHdvcyBcInVzZSBkZWZhdWx0UGFnZVwiIGVycm9yKVxuXHRcdGlmIChpc0ludmlzaWJsZU5vZGUoY2hpbGQpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fSBlbHNlIGlmIChjaGlsZCBpbnN0YW5jZW9mIFBhZ2UpIHtcblx0XHRcdHBhcmVudC5uYXZpZ2F0ZSh7IGNyZWF0ZTogKCkgPT4gY2hpbGQgfSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignT25seSBhIFBhZ2UgY2FuIGJlIGEgY2hpbGQgb2YgRnJhbWUnKTtcblx0XHR9XG5cdH0sXG59O1xuXG4vLyBSZWdpc3RlciBkZWZhdWx0IE5hdGl2ZVNjcmlwdCBjb21wb25lbnRzXG4vLyBOb3RlOiBBY3Rpb25CYXIgcmVsYXRlZCBjb21wb25lbnRzIGFyZSByZWdpc3RlcmQgdG9nZXRoZXIgd2l0aCBhY3Rpb24tYmFyIGRpcmVjdGl2ZXMuXG5yZWdpc3RlckVsZW1lbnQoJ0Fic29sdXRlTGF5b3V0JywgKCkgPT4gQWJzb2x1dGVMYXlvdXQpO1xucmVnaXN0ZXJFbGVtZW50KCdBY3Rpdml0eUluZGljYXRvcicsICgpID0+IEFjdGl2aXR5SW5kaWNhdG9yKTtcbnJlZ2lzdGVyRWxlbWVudCgnQm90dG9tTmF2aWdhdGlvbicsICgpID0+IEJvdHRvbU5hdmlnYXRpb24pO1xucmVnaXN0ZXJFbGVtZW50KCdCdXR0b24nLCAoKSA9PiBCdXR0b24pO1xucmVnaXN0ZXJFbGVtZW50KCdDb250ZW50VmlldycsICgpID0+IENvbnRlbnRWaWV3KTtcbnJlZ2lzdGVyRWxlbWVudCgnRGF0ZVBpY2tlcicsICgpID0+IERhdGVQaWNrZXIpO1xucmVnaXN0ZXJFbGVtZW50KCdEb2NrTGF5b3V0JywgKCkgPT4gRG9ja0xheW91dCk7XG5yZWdpc3RlckVsZW1lbnQoJ0ZyYW1lJywgKCkgPT4gPGFueT5GcmFtZSwgZnJhbWVNZXRhKTtcbnJlZ2lzdGVyRWxlbWVudCgnR3JpZExheW91dCcsICgpID0+IEdyaWRMYXlvdXQpO1xucmVnaXN0ZXJFbGVtZW50KCdIdG1sVmlldycsICgpID0+IEh0bWxWaWV3KTtcbnJlZ2lzdGVyRWxlbWVudCgnSW1hZ2UnLCAoKSA9PiBJbWFnZSk7XG4vLyBQYXJzZTUgY2hhbmdlcyA8SW1hZ2U+IHRhZ3MgdG8gPGltZz4uIFdURiFcbnJlZ2lzdGVyRWxlbWVudCgnaW1nJywgKCkgPT4gSW1hZ2UpO1xucmVnaXN0ZXJFbGVtZW50KCdMYWJlbCcsICgpID0+IExhYmVsKTtcbnJlZ2lzdGVyRWxlbWVudCgnTGlzdFBpY2tlcicsICgpID0+IExpc3RQaWNrZXIpO1xucmVnaXN0ZXJFbGVtZW50KCdMaXN0VmlldycsICgpID0+IExpc3RWaWV3KTtcbnJlZ2lzdGVyRWxlbWVudCgnUGFnZScsICgpID0+IFBhZ2UpO1xucmVnaXN0ZXJFbGVtZW50KCdQbGFjZWhvbGRlcicsICgpID0+IFBsYWNlaG9sZGVyKTtcbnJlZ2lzdGVyRWxlbWVudCgnUHJvZ3Jlc3MnLCAoKSA9PiBQcm9ncmVzcyk7XG5yZWdpc3RlckVsZW1lbnQoJ1Byb3h5Vmlld0NvbnRhaW5lcicsICgpID0+IFByb3h5Vmlld0NvbnRhaW5lcik7XG5yZWdpc3RlckVsZW1lbnQoJ1JlcGVhdGVyJywgKCkgPT4gUmVwZWF0ZXIpO1xucmVnaXN0ZXJFbGVtZW50KCdTY3JvbGxWaWV3JywgKCkgPT4gU2Nyb2xsVmlldyk7XG5yZWdpc3RlckVsZW1lbnQoJ1NlYXJjaEJhcicsICgpID0+IFNlYXJjaEJhcik7XG5yZWdpc3RlckVsZW1lbnQoJ1NlZ21lbnRlZEJhcicsICgpID0+IFNlZ21lbnRlZEJhcik7XG5yZWdpc3RlckVsZW1lbnQoJ1NlZ21lbnRlZEJhckl0ZW0nLCAoKSA9PiA8YW55PlNlZ21lbnRlZEJhckl0ZW0pO1xucmVnaXN0ZXJFbGVtZW50KCdTbGlkZXInLCAoKSA9PiBTbGlkZXIpO1xucmVnaXN0ZXJFbGVtZW50KCdTdGFja0xheW91dCcsICgpID0+IFN0YWNrTGF5b3V0KTtcbnJlZ2lzdGVyRWxlbWVudCgnRmxleGJveExheW91dCcsICgpID0+IEZsZXhib3hMYXlvdXQpO1xucmVnaXN0ZXJFbGVtZW50KCdTd2l0Y2gnLCAoKSA9PiBTd2l0Y2gpO1xucmVnaXN0ZXJFbGVtZW50KCdUYWJWaWV3JywgKCkgPT4gVGFiVmlldyk7XG5yZWdpc3RlckVsZW1lbnQoJ1RhYlN0cmlwJywgKCkgPT4gVGFiU3RyaXApO1xucmVnaXN0ZXJFbGVtZW50KCdUYWJTdHJpcEl0ZW0nLCAoKSA9PiBUYWJTdHJpcEl0ZW0pO1xucmVnaXN0ZXJFbGVtZW50KCdUYWJDb250ZW50SXRlbScsICgpID0+IFRhYkNvbnRlbnRJdGVtKTtcbnJlZ2lzdGVyRWxlbWVudCgnVGFicycsICgpID0+IFRhYnMpO1xucmVnaXN0ZXJFbGVtZW50KCdUZXh0RmllbGQnLCAoKSA9PiBUZXh0RmllbGQpO1xucmVnaXN0ZXJFbGVtZW50KCdUZXh0VmlldycsICgpID0+IFRleHRWaWV3KTtcbnJlZ2lzdGVyRWxlbWVudCgnVGltZVBpY2tlcicsICgpID0+IFRpbWVQaWNrZXIpO1xucmVnaXN0ZXJFbGVtZW50KCdXZWJWaWV3JywgKCkgPT4gV2ViVmlldyk7XG5yZWdpc3RlckVsZW1lbnQoJ1dyYXBMYXlvdXQnLCAoKSA9PiBXcmFwTGF5b3V0KTtcbnJlZ2lzdGVyRWxlbWVudCgnRm9ybWF0dGVkU3RyaW5nJywgKCkgPT4gPGFueT5Gb3JtYXR0ZWRTdHJpbmcpO1xucmVnaXN0ZXJFbGVtZW50KCdTcGFuJywgKCkgPT4gPGFueT5TcGFuKTtcblxucmVnaXN0ZXJFbGVtZW50KCdEZXRhY2hlZENvbnRhaW5lcicsICgpID0+IFByb3h5Vmlld0NvbnRhaW5lciwge1xuXHRza2lwQWRkVG9Eb206IHRydWUsXG59KTtcblxucmVnaXN0ZXJFbGVtZW50KCdwYWdlLXJvdXRlci1vdXRsZXQnLCAoKSA9PiA8YW55PkZyYW1lKTtcbiJdfQ==